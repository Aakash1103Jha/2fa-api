# 2FA API

## Stack

-   NodeJS
-   ExpressJS
-   Docker
-   SendGrid Mail

## Prerequisite

-   SendGrid account and api key (Read more: [Integration Docs])

## Environment Variables

-   `DATABASE_URL=`
-   `AUTH_TOKEN_SECRET=`
-   `REGISTER_VERIFICATION_TOKEN_SECRET=`
-   `COOKIE_SECRET=`
-   `SENDGRID_API_KEY=`
-   `ADMIN_EMAIL=`

## Functional Implementation

> This description also includes how the UI would look for the user.

### Sign Up Flow with _confirm email to complete sign up_

-   The user will land on sign up page where they will be presented with a single, mandatory, email field, and a Next button, initially disabled.
-   Field level validation for email should be performed as the user enters the value.
-   Once the user fills in the email and clicks on Next, the email should be checked for an already existing account with it.
-   If the email is already in use/associated with another account, the user should see an EmailAlreadyInUse error, else the user should be presented with other mandatory fields - first name, last name, password and confirm password.
-   At this point, button label should be changed to “Receive Confirmation Link”.
-   The password should be validated for complexity based on certain criteria. Default criteria is minimum 8 characters and an uppercase character.
-   If password validation fails, the user should see a WeakPasswordError.
-   Once all data is validated and no error is received, the user should be able to click Receive Confirmation Link button.
-   The link received by the user should look like `www.example.com/api/auth/verify?token=<TOKEN>`, where TOKEN will be generated by the register controller, with the complete user data object as payload.
-   On clicking the link, the token will be validated, before completing the sign up process.
-   If the token has expired, the user should see a ConfirmationLinkExpired error, and should be redirected back to the sign up page.
-   If the token is valid, the user data should be extracted and saved into the database. Once successful, the user should see a “Account Created Successfully” message, and be redirected to login page.

![Auth Flow Diagrams-2](https://github.com/Aakash1103Jha/2fa-api/assets/52240895/d8fdf632-61e8-446a-a621-41f44a850bb3)

![Auth Flow Diagrams](https://github.com/Aakash1103Jha/2fa-api/assets/52240895/4b24d7a3-e492-429a-be1e-b4310d260012)

[Integration Docs]: https://docs.sendgrid.com/for-developers/sending-email/api-getting-started

